services:
  - docker

before_install:
  - docker pull rust:1.44.0

before_script:
  - sudo apt update
  - sudo apt install ruby-coveralls

script:
  - docker run -it -v $PWD:/teaclave -w /teaclave rust:1.44.0 /bin/sh -c "cargo build; cargo test"

after_success:
  - coveralls --data_file=./cov.info

cache:
  directories:
    - .cache
